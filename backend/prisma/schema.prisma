generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model campaign {
  campaign_id       String              @id @db.VarChar(50)
  campaign_name     String?             @db.VarChar(100)
  notification_type notif_type
  city_filter       String?             @db.VarChar(50)
  gender_filter     gender_type
  created_by        String              @db.VarChar(50)
  status            status_type
  staff             staff               @relation(fields: [created_by], references: [staff_id], onDelete: NoAction, onUpdate: NoAction)
  notification_logs notification_logs[]
}

model notification_logs {
  user_id     String     @db.VarChar(50)
  campaign_id String     @db.VarChar(50)
  sent_at     DateTime?  @db.Timestamptz(6)
  status      log_status
  campaign    campaign   @relation(fields: [campaign_id], references: [campaign_id], onDelete: NoAction, onUpdate: NoAction)
  users       users      @relation(fields: [user_id], references: [user_id], onDelete: NoAction, onUpdate: NoAction)

  @@id([user_id, campaign_id])
}

model preference {
  preference_id String  @id @db.VarChar(50)
  user_id       String? @unique @db.VarChar(50)
  offers        String? @db.VarChar(50)
  order_updates String? @db.VarChar(50)
  newsletter    String? @db.VarChar(50)
  users         users?  @relation(fields: [user_id], references: [user_id], onDelete: NoAction, onUpdate: NoAction)
}

model staff {
  staff_id String     @id @db.VarChar(50)
  name     String?    @db.VarChar(50)
  email    String     @unique @db.VarChar(100)
  password String?    @db.VarChar(255)
  role     role_type
  campaign campaign[]
}

model users {
  user_id           String              @id @db.VarChar(50)
  name              String              @db.VarChar(100)
  email             String              @unique @db.VarChar(100)
  password          String              @db.VarChar(255)
  phone             String              @db.VarChar(10)
  city              String              @db.VarChar(50)
  gender            gender_type
  is_active         Boolean?            @default(true)
  notification_logs notification_logs[]
  preference        preference?
}

enum gender_type {
  MALE
  FEMALE
  NONE
}

enum log_status {
  SUCCESS
  FAILED
}

enum notif_type {
  OFFER
  ORDER_UPDATE
  NEWSLETTER
}

enum role_type {
  ADMIN
  CREATOR
  VIEWER
}

enum status_type {
  DRAFT
  SENT
}
